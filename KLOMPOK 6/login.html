<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameHub - Login</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="login-page">
    <!-- Efek Visual -->
    <div class="stars-container"></div>
    <div class="lightning-container"></div>
    <div class="lightning-flash"></div>
    <div id="realLightningContainer"></div>
    
    <!-- Header Bagian Login -->
    <header>
        <div class="container">
        <nav>
        <div class="logo-group">
            <img src="image/maloetta.png" alt="GameHub Logo" class="logo-img">
        <div class="logo">GameHub</div>
        </div>
        <ul class="nav-links">
            <li><a href="login.html">Login</a></li>
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="#profil" onclick="showProfile()">Profil</a></li>
        </ul>
        </nav>
        </div>
    </header>

    <!-- Form Login -->
    <section class="login-container">
        <div class="login-form">
            <h2>Masuk ke GameHub</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Masukkan username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Masukkan password" required>
                </div>
                <button type="submit" class="btn">Masuk</button>
            </form>
            <div class="register-link">
                <p>Belum punya akun? <a href="#daftar" onclick="showRegister()">Daftar di sini</a></p>
            </div>
            <!-- Demo Account Info -->
            <div class="demo-account">
                <p><strong>Akun Demo:</strong></p>
                <p>Username: <code>demo</code></p>
                <p>Password: <code>demo123</code></p>
            </div>
        </div>
    </section>

    <!-- Modal Profil -->
    <div id="profileModal" class="modal">
        <div class="modal-content profile-modal">
            <span class="close-modal" onclick="closeProfile()">&times;</span>
            <h2>Profil Pengguna</h2>
            <div class="profile-info">
                <div class="profile-avatar">
                    <div class="avatar-placeholder">ðŸ‘¤</div>
                </div>
                <div class="profile-details">
                    <div class="detail-item">
                        <label>Nama:</label>
                        <span id="profileName">-</span>
                    </div>
                    <div class="detail-item">
                        <label>Email:</label>
                        <span id="profileEmail">-</span>
                    </div>
                    <div class="detail-item">
                        <label>Username:</label>
                        <span id="profileUsername">-</span>
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button class="btn btn-secondary" onclick="showChangePassword()">Ubah Password</button>
            </div>
            <div class="rated-games-section">
                <h3>Game yang Sudah Di-rating</h3>
                <div id="ratedGamesList" class="rated-games-list">
                    <p class="no-data">Belum ada game yang di-rating</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ubah Password -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeChangePassword()">&times;</span>
            <h2>Ubah Password</h2>
            <form id="changePasswordForm">
                <div class="form-group">
                    <label for="currentPassword">Password Saat Ini</label>
                    <input type="password" id="currentPassword" required>
                </div>
                <div class="form-group">
                    <label for="newPassword">Password Baru</label>
                    <input type="password" id="newPassword" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Konfirmasi Password Baru</label>
                    <input type="password" id="confirmPassword" required>
                </div>
                <button type="submit" class="btn">Simpan Perubahan</button>
            </form>
        </div>
    </div>

    <!-- Modal Daftar -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeRegister()">&times;</span>
            <h2>Daftar Akun Baru</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label for="regName">Nama Lengkap</label>
                    <input type="text" id="regName" required>
                </div>
                <div class="form-group">
                    <label for="regEmail">Email</label>
                    <input type="email" id="regEmail" required>
                </div>
                <div class="form-group">
                    <label for="regUsername">Username</label>
                    <input type="text" id="regUsername" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" required>
                </div>
                <button type="submit" class="btn">Daftar</button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">GameHub</div>
                <ul class="footer-links">
                    <li><a href="#tentang">Tentang Kami</a></li>
                    <li><a href="#privasi">Kebijakan Privasi</a></li>
                    <li><a href="#syarat">Syarat dan Ketentuan</a></li>
                    <li><a href="#kontak">Kontak</a></li>
                </ul>
                <p class="copyright">&copy; 2023 GameHub. Semua hak dilindungi.</p>
            </div>
        </div>
    </footer>

    <script>
        // Inisialisasi data user dengan akun demo
        function initializeUsers() {
            let users = JSON.parse(localStorage.getItem('gamehub_users'));
            if (!users || users.length === 0) {
                users = [
                    {
                        name: "Demo User",
                        email: "demo@gamehub.com",
                        username: "demo",
                        password: "demo123"
                    }
                ];
                localStorage.setItem('gamehub_users', JSON.stringify(users));
            }
            return users;
        }

        // Data user
        let users = initializeUsers();
        let currentUser = JSON.parse(localStorage.getItem('gamehub_current_user')) || null;
        let userRatings = JSON.parse(localStorage.getItem('gamehub_ratings')) || {};

        // Fungsi untuk membuat efek petir
        function createLightning() {
            const lightningContainer = document.querySelector('.lightning-container');
            const lightningFlash = document.querySelector('.lightning-flash');
            
            if (lightningContainer && lightningFlash) {
                lightningContainer.innerHTML = '';
                const lightningCount = 1 + Math.floor(Math.random() * 3);
                
                for (let i = 0; i < lightningCount; i++) {
                    const lightning = document.createElement('div');
                    lightning.classList.add('lightning');
                    const left = 10 + Math.random() * 80;
                    const height = 30 + Math.random() * 50;
                    lightning.style.left = `${left}%`;
                    lightning.style.height = `${height}%`;
                    lightningContainer.appendChild(lightning);
                }
                
                lightningFlash.classList.add('active');
                setTimeout(() => {
                    lightningFlash.classList.remove('active');
                }, 300);
                
                setTimeout(() => {
                    lightningContainer.innerHTML = '';
                }, 1000);
            }
        }

        // Fungsi untuk membuat petir realistis
        function createRealisticLightning() {
            const container = document.getElementById('realLightningContainer');
            if (!container) return;
            
            container.innerHTML = '';
            const lightning = document.createElement('div');
            lightning.className = 'real-lightning';
            
            const startX = 20 + Math.random() * 60;
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            svg.setAttribute("width", "100%");
            svg.setAttribute("height", "100%");
            svg.setAttribute("viewBox", "0 0 100 100");
            svg.style.position = "absolute";
            svg.style.top = "0";
            svg.style.left = "0";
            svg.style.pointerEvents = "none";
            
            const mainPath = document.createElementNS(svgNS, "path");
            let pathData = `M ${startX} 10 `;
            let currentX = startX;
            let currentY = 10;
            const segments = 8 + Math.floor(Math.random() * 6);
            
            for (let i = 0; i < segments; i++) {
                const segmentLength = 5 + Math.random() * 8;
                const direction = Math.random() > 0.5 ? 1 : -1;
                const bend = 3 + Math.random() * 4;
                const nextX = currentX + (direction * bend);
                const nextY = currentY + segmentLength;
                const controlX1 = currentX + (direction * bend * 0.3);
                const controlY1 = currentY + segmentLength * 0.3;
                const controlX2 = currentX + (direction * bend * 0.7);
                const controlY2 = currentY + segmentLength * 0.7;
                pathData += `C ${controlX1} ${controlY1}, ${controlX2} ${controlY2}, ${nextX} ${nextY} `;
                currentX = nextX;
                currentY = nextY;
                if (currentY >= 80) break;
            }
            
            mainPath.setAttribute("d", pathData);
            mainPath.setAttribute("fill", "none");
            mainPath.setAttribute("stroke", "#ffffff");
            mainPath.setAttribute("stroke-width", "1.5");
            mainPath.setAttribute("stroke-linecap", "round");
            mainPath.setAttribute("stroke-linejoin", "round");
            
            const defs = document.createElementNS(svgNS, "defs");
            const filter = document.createElementNS(svgNS, "filter");
            filter.setAttribute("id", "lightning-glow");
            filter.setAttribute("x", "-50%");
            filter.setAttribute("y", "-50%");
            filter.setAttribute("width", "200%");
            filter.setAttribute("height", "200%");
            
            const feGaussianBlur = document.createElementNS(svgNS, "feGaussianBlur");
            feGaussianBlur.setAttribute("in", "SourceGraphic");
            feGaussianBlur.setAttribute("stdDeviation", "2");
            feGaussianBlur.setAttribute("result", "blur");
            
            const feColorMatrix = document.createElementNS(svgNS, "feColorMatrix");
            feColorMatrix.setAttribute("in", "blur");
            feColorMatrix.setAttribute("type", "matrix");
            feColorMatrix.setAttribute("values", "1 0 0 0 0  0 1 0 0 0.8  0 0 1 0 0.9  0 0 0 1 0");
            feColorMatrix.setAttribute("result", "coloredBlur");
            
            const feMerge = document.createElementNS(svgNS, "feMerge");
            const feMergeNode1 = document.createElementNS(svgNS, "feMergeNode");
            feMergeNode1.setAttribute("in", "coloredBlur");
            const feMergeNode2 = document.createElementNS(svgNS, "feMergeNode");
            feMergeNode2.setAttribute("in", "SourceGraphic");
            
            feMerge.appendChild(feMergeNode1);
            feMerge.appendChild(feMergeNode2);
            filter.appendChild(feGaussianBlur);
            filter.appendChild(feColorMatrix);
            filter.appendChild(feMerge);
            defs.appendChild(filter);
            svg.appendChild(defs);
            svg.appendChild(mainPath);
            lightning.appendChild(svg);
            container.appendChild(lightning);
            
            setTimeout(() => {
                lightning.style.opacity = '1';
            }, 10);
            
            setTimeout(() => {
                if (lightning.parentNode) {
                    lightning.parentNode.removeChild(lightning);
                }
            }, 800);
            
            const flash = document.createElement('div');
            flash.className = 'lightning-flash-real';
            container.appendChild(flash);
            setTimeout(() => {
                if (flash.parentNode) {
                    flash.parentNode.removeChild(flash);
                }
            }, 600);
        }

        // Fungsi untuk bintang
        function createStarShape() {
            const star = document.createElement('div');
            star.classList.add('star-shape');
            for (let i = 0; i < 5; i++) {
                const point = document.createElement('div');
                point.classList.add('star-point');
                star.appendChild(point);
            }
            return star;
        }

        function createStars() {
            const starsContainer = document.querySelector('.stars-container');
            if (!starsContainer) return;
            starsContainer.innerHTML = '';
            const starCount = Math.floor(window.innerWidth / 30);
            for (let i = 0; i < starCount; i++) {
                const star = createStarShape();
                const left = Math.random() * 100;
                const delay = Math.random() * 20;
                const duration = 5 + Math.random() * 10;
                const size = 5 + Math.random() * 10;
                const opacity = 0.3 + Math.random() * 0.7;
                star.style.left = `${left}%`;
                star.style.animationDelay = `${delay}s`;
                star.style.animationDuration = `${duration}s`;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.opacity = opacity;
                starsContainer.appendChild(star);
            }
        }

        // Fungsi untuk profil
        function showProfile() {
            if (!currentUser) {
                alert('Silakan login terlebih dahulu');
                return;
            }
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('profileUsername').textContent = currentUser.username;
            updateRatedGamesList();
            document.getElementById('profileModal').style.display = 'block';
        }

        function closeProfile() {
            document.getElementById('profileModal').style.display = 'none';
        }

        function showChangePassword() {
            closeProfile();
            document.getElementById('changePasswordModal').style.display = 'block';
        }

        function closeChangePassword() {
            document.getElementById('changePasswordModal').style.display = 'none';
        }

        function showRegister() {
            document.getElementById('registerModal').style.display = 'block';
        }

        function closeRegister() {
            document.getElementById('registerModal').style.display = 'none';
        }

        function updateRatedGamesList() {
            const ratedGamesList = document.getElementById('ratedGamesList');
            const userRatingKey = `${currentUser.username}_ratings`;
            const ratings = userRatings[userRatingKey] || [];
            
            if (ratings.length === 0) {
                ratedGamesList.innerHTML = '<p class="no-data">Belum ada game yang di-rating</p>';
                return;
            }
            
            ratedGamesList.innerHTML = ratings.map(rating => `
                <div class="rated-game-item">
                    <div class="game-title">${rating.gameTitle}</div>
                    <div class="game-rating">Rating: ${'â˜…'.repeat(rating.rating)}${'â˜†'.repeat(5-rating.rating)}</div>
                    <div class="review-preview">${rating.review || 'Tidak ada review'}</div>
                </div>
            `).join('');
        }

        // Event Listeners
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            console.log('Login attempt:', username, password); // Debug
            console.log('Available users:', users); // Debug
            
            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('gamehub_current_user', JSON.stringify(user));
                alert('Login berhasil!');
                window.location.href = 'dashboard.html';
            } else {
                alert('Username atau password salah!');
            }
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            
            if (users.find(u => u.username === username)) {
                alert('Username sudah digunakan!');
                return;
            }
            
            const newUser = { name, email, username, password };
            users.push(newUser);
            localStorage.setItem('gamehub_users', JSON.stringify(users));
            alert('Pendaftaran berhasil! Silakan login.');
            closeRegister();
            
            // Reset form
            document.getElementById('registerForm').reset();
        });

        document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (currentPassword !== currentUser.password) {
                alert('Password saat ini salah!');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('Konfirmasi password tidak sesuai!');
                return;
            }
            
            currentUser.password = newPassword;
            const userIndex = users.findIndex(u => u.username === currentUser.username);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('gamehub_users', JSON.stringify(users));
                localStorage.setItem('gamehub_current_user', JSON.stringify(currentUser));
                alert('Password berhasil diubah!');
                closeChangePassword();
                
                // Reset form
                document.getElementById('changePasswordForm').reset();
            }
        });

        // Jalankan efek saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            setInterval(() => {
                if (Math.random() > 0.6) {
                    createLightning();
                }
            }, 8000);
            setInterval(() => {
                createRealisticLightning();
            }, 4000 + Math.random() * 4000);
            window.addEventListener('resize', createStars);
            setTimeout(() => {
                createLightning();
                createRealisticLightning();
            }, 1500);

            // Cek jika user sudah login
            if (currentUser) {
                document.getElementById('username').value = currentUser.username;
            }
            
            // Debug: Tampilkan data users di console
            console.log('Current users:', users);
        });
    </script>
</body>
</html>